<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø®Ø§Ø±Ø·Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body{
  background:#0f172a;
  color:white;
  font-family:Arial;
  margin:0;
  padding:20px;
}
#map{
  height:450px;
  border-radius:15px;
}
button{
  margin:5px;
  padding:10px 15px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
</style>
</head>

<body>

<h2>Ø§Ù„Ø®Ø§Ø±Ø·Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h2>

<button onclick="updateMap('all')">Ø§Ù„ÙƒÙ„</button>
<button onclick="updateMap('affected')">Ø§Ù„Ù…ØªØ¶Ø±Ø±Ø©</button>
<button onclick="updateMap('hope')">Ø§Ù„Ø£Ù…Ù„</button>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
let map;
let markers=[];

/* ğŸŸ¢ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ */
const locations=[
  {
    id:"spiker",
    name:"Ù‚Ø§Ø¹Ø¯Ø© Ø³Ø¨Ø§ÙŠÙƒØ± â€“ ØªÙƒØ±ÙŠØª",
    coords:[34.7475,43.5847],
    category:"affected"
  },
  {
    id:"badoush",
    name:"Ø³Ø¬Ù† Ø¨Ø§Ø¯ÙˆØ´",
    coords:[36.4253,42.9231],
    category:"affected"
  },
  {
    id:"khasfa",
    name:"Ø­ÙØ±Ø© Ø§Ù„Ø®Ø³ÙØ©",
    coords:[36.1458,43.1206],
    category:"affected"
  },
  {
    id:"sinjar",
    name:"Ø³Ù†Ø¬Ø§Ø± â€“ Ø¬Ø¨Ù„ Ø³Ù†Ø¬Ø§Ø±",
    coords:[36.3195,41.8596],
    category:"affected"
  },
  {
    id:"mosul_old_city",
    name:"Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© â€“ Ø§Ù„Ù…ÙˆØµÙ„",
    coords:[36.34,43.13],
    category:"affected"
  },
  {
    id:"erbil",
    name:"Ø£Ø±Ø¨ÙŠÙ„",
    coords:[36.1911,44.0092],
    category:"hope"
  }
];

/* ğŸŸ¥ Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡ */
const martyrs=[
  {locationId:"spiker",name:"Ø¨Ø§Ø³Ù… Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠÙˆÙŠ ÙØ²Ø¹ Ø§Ù„Ø±ÙƒØ§Ø¨ÙŠ"},
  {locationId:"spiker",name:"Ø­Ø³Ù† Ù†Ø§ØµØ± Ø­Ø³ÙŠÙ† Ù…Ø­Ù…Ø¯ Ø¢Ù„ Ø£Ø²ÙŠØ±Ø¬"},
  {locationId:"badoush",name:"ÙˆÙ„ÙŠØ¯ Ø®Ø§Ù„Ø¯ Ù‡Ø§Ù…Ù„"},
  {locationId:"badoush",name:"Ø­ÙŠØ¯Ø± Ù‚Ø§Ø³Ù… Ø®Ù„ÙŠÙ„"},
  {locationId:"khasfa",name:"Ø§Ù„Ø±Ø§Ø¦Ø¯ ÙŠÙˆÙ†Ø³ Ù…Ø±Ø¹ÙŠ Ø§Ù„Ø­ÙˆÙŠØ²ÙŠ"},
  {locationId:"sinjar",name:"Ø§Ù„Ø´ÙŠØ® Ù†Ø§ØµØ± Ø¨Ø§Ø´Ø§"},
  {locationId:"mosul_old_city",name:"Ø§Ù„Ù„ÙˆØ§Ø¡ Ø§Ù„Ø±ÙƒÙ† Ù†Ø¬Ù… Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ"}
];

map=L.map("map").setView([33.3,44.3],6);

L.tileLayer(
  "https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"
).addTo(map);

function updateMap(filter){
  markers.forEach(m=>map.removeLayer(m));
  markers=[];

  locations.forEach(loc=>{
    if(filter==="all"||loc.category===filter){
      const color=loc.category==="affected"?"#ef4444":"#22c55e";

      const marker=L.circleMarker(loc.coords,{
        color:color,
        fillColor:color,
        fillOpacity:0.8,
        radius:12
      }).addTo(map);

      marker.bindPopup(`<b>${loc.name}</b><br>Ø§Ù†Ù‚Ø± Ù…Ø±ØªÙŠÙ† Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡`);

      marker.on("dblclick",()=>showMartyrs(loc.id,loc.coords));

      markers.push(marker);
    }
  });
}

function showMartyrs(locationId,coords){
  const list=martyrs.filter(m=>m.locationId===locationId);

  if(list.length===0){
    alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ù…Ø§Ø¡ Ù…Ø³Ø¬Ù„Ø©");
    return;
  }

  let html="<h3>Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡</h3><ul>";
  list.forEach(m=>{
    html+=`<li>${m.name}</li>`;
  });
  html+="</ul>";

  L.popup()
    .setLatLng(coords)
    .setContent(html)
    .openOn(map);
}

updateMap("all");
</script>

</body>
</html>
